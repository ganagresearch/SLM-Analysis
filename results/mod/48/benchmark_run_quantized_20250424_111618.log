2025-04-24 11:16:18,711 - INFO - --- Starting Security Benchmark Automation (QUANTIZED MODELS) ---
2025-04-24 11:16:18,712 - INFO - Using Python: /workspace/testbedvenv/bin/python
2025-04-24 11:16:18,713 - INFO - Evaluation Script: /workspace/code/model_evaluator/evaluate_cli.py
2025-04-24 11:16:18,713 - INFO - Results Directory: /workspace/results/mod/48
2025-04-24 11:16:18,715 - INFO - Error Log File: /workspace/results/mod/48/automation_quantized_errors.log
2025-04-24 11:16:18,715 - INFO - Run Log File: /workspace/results/mod/48/benchmark_run_quantized_20250424_111618.log
2025-04-24 11:16:18,716 - INFO - Models to run: ['Phi-3-mini-4k-instruct-GPTQ', 'Mistral-7B-Instruct-v0.3-GPTQ']
2025-04-24 11:16:18,716 - INFO - Benchmarks to run: [('cyberseceval3_mitre', [None]), ('sevenllm_bench', [None]), ('ctibench', ['cti-mcq', 'cti-vsp', 'cti-rcm'])]
2025-04-24 11:16:18,717 - INFO - Running 100 samples per benchmark.
2025-04-24 11:16:18,717 - INFO - Max New Tokens for Causal Models: 512
2025-04-24 11:16:18,718 - INFO - 
Run 1/10: Model='Phi-3-mini-4k-instruct-GPTQ', Benchmark='cyberseceval3_mitre'
2025-04-24 11:16:18,720 - INFO - Executing command: /workspace/testbedvenv/bin/python /workspace/code/model_evaluator/evaluate_cli.py --model-path /workspace/models/Phi-3-mini-4k-instruct-GPTQ --model-type causal --benchmark-name cyberseceval3_mitre --benchmark-path /workspace/code/PurpleLlama/CybersecurityBenchmarks/datasets/mitre/mitre_benchmark_100_per_category_with_augmentation.json --results-dir /workspace/results/mod/48 --num-samples 100 --max-new-tokens 512
2025-04-24 11:16:38,633 - WARNING - Stderr:
/workspace/testbedvenv/lib/python3.11/site-packages/torch/_subclasses/functional_tensor.py:276: UserWarning: Failed to initialize NumPy: No module named 'numpy' (Triggered internally at /pytorch/torch/csrc/utils/tensor_numpy.cpp:81.)
  cpu = _conversion_method_template(device=torch.device("cpu"))
Traceback (most recent call last):
  File "/workspace/code/model_evaluator/evaluate_cli.py", line 9, in <module>
    from evaluation_utils import setup_logging, init_nvml, shutdown_nvml, get_memory_usage, NVML_FOUND
  File "/workspace/code/model_evaluator/evaluation_utils.py", line 1, in <module>
    import psutil
ModuleNotFoundError: No module named 'psutil'

2025-04-24 11:16:38,635 - ERROR - ERROR during: Run 1/10: Model='Phi-3-mini-4k-instruct-GPTQ', Benchmark='cyberseceval3_mitre'
  Command: /workspace/testbedvenv/bin/python /workspace/code/model_evaluator/evaluate_cli.py --model-path /workspace/models/Phi-3-mini-4k-instruct-GPTQ --model-type causal --benchmark-name cyberseceval3_mitre --benchmark-path /workspace/code/PurpleLlama/CybersecurityBenchmarks/datasets/mitre/mitre_benchmark_100_per_category_with_augmentation.json --results-dir /workspace/results/mod/48 --num-samples 100 --max-new-tokens 512
  Return Code: 1
  Stderr:
/workspace/testbedvenv/lib/python3.11/site-packages/torch/_subclasses/functional_tensor.py:276: UserWarning: Failed to initialize NumPy: No module named 'numpy' (Triggered internally at /pytorch/torch/csrc/utils/tensor_numpy.cpp:81.)
  cpu = _conversion_method_template(device=torch.device("cpu"))
Traceback (most recent call last):
  File "/workspace/code/model_evaluator/evaluate_cli.py", line 9, in <module>
    from evaluation_utils import setup_logging, init_nvml, shutdown_nvml, get_memory_usage, NVML_FOUND
  File "/workspace/code/model_evaluator/evaluation_utils.py", line 1, in <module>
    import psutil
ModuleNotFoundError: No module named 'psutil'

----------------------------------------

2025-04-24 11:16:38,638 - INFO - 
Run 2/10: Model='Phi-3-mini-4k-instruct-GPTQ', Benchmark='sevenllm_bench'
2025-04-24 11:16:38,640 - INFO - Executing command: /workspace/testbedvenv/bin/python /workspace/code/model_evaluator/evaluate_cli.py --model-path /workspace/models/Phi-3-mini-4k-instruct-GPTQ --model-type causal --benchmark-name sevenllm_bench --benchmark-path /workspace/calibration_data/sevenllm_instruct_subset_manual/ --results-dir /workspace/results/mod/48 --num-samples 100 --max-new-tokens 512
2025-04-24 11:16:45,152 - WARNING - Stderr:
/workspace/testbedvenv/lib/python3.11/site-packages/torch/_subclasses/functional_tensor.py:276: UserWarning: Failed to initialize NumPy: No module named 'numpy' (Triggered internally at /pytorch/torch/csrc/utils/tensor_numpy.cpp:81.)
  cpu = _conversion_method_template(device=torch.device("cpu"))
Traceback (most recent call last):
  File "/workspace/code/model_evaluator/evaluate_cli.py", line 9, in <module>
    from evaluation_utils import setup_logging, init_nvml, shutdown_nvml, get_memory_usage, NVML_FOUND
  File "/workspace/code/model_evaluator/evaluation_utils.py", line 1, in <module>
    import psutil
ModuleNotFoundError: No module named 'psutil'

2025-04-24 11:16:45,153 - ERROR - ERROR during: Run 2/10: Model='Phi-3-mini-4k-instruct-GPTQ', Benchmark='sevenllm_bench'
  Command: /workspace/testbedvenv/bin/python /workspace/code/model_evaluator/evaluate_cli.py --model-path /workspace/models/Phi-3-mini-4k-instruct-GPTQ --model-type causal --benchmark-name sevenllm_bench --benchmark-path /workspace/calibration_data/sevenllm_instruct_subset_manual/ --results-dir /workspace/results/mod/48 --num-samples 100 --max-new-tokens 512
  Return Code: 1
  Stderr:
/workspace/testbedvenv/lib/python3.11/site-packages/torch/_subclasses/functional_tensor.py:276: UserWarning: Failed to initialize NumPy: No module named 'numpy' (Triggered internally at /pytorch/torch/csrc/utils/tensor_numpy.cpp:81.)
  cpu = _conversion_method_template(device=torch.device("cpu"))
Traceback (most recent call last):
  File "/workspace/code/model_evaluator/evaluate_cli.py", line 9, in <module>
    from evaluation_utils import setup_logging, init_nvml, shutdown_nvml, get_memory_usage, NVML_FOUND
  File "/workspace/code/model_evaluator/evaluation_utils.py", line 1, in <module>
    import psutil
ModuleNotFoundError: No module named 'psutil'

----------------------------------------

2025-04-24 11:16:45,157 - INFO - 
Run 3/10: Model='Phi-3-mini-4k-instruct-GPTQ', Benchmark='ctibench', Subset='cti-mcq'
2025-04-24 11:16:45,158 - INFO - Executing command: /workspace/testbedvenv/bin/python /workspace/code/model_evaluator/evaluate_cli.py --model-path /workspace/models/Phi-3-mini-4k-instruct-GPTQ --model-type causal --benchmark-name ctibench --benchmark-path /workspace/datasets --results-dir /workspace/results/mod/48 --num-samples 100 --cti-subset cti-mcq --max-new-tokens 512
2025-04-24 11:16:50,946 - WARNING - Stderr:
/workspace/testbedvenv/lib/python3.11/site-packages/torch/_subclasses/functional_tensor.py:276: UserWarning: Failed to initialize NumPy: No module named 'numpy' (Triggered internally at /pytorch/torch/csrc/utils/tensor_numpy.cpp:81.)
  cpu = _conversion_method_template(device=torch.device("cpu"))
Traceback (most recent call last):
  File "/workspace/code/model_evaluator/evaluate_cli.py", line 9, in <module>
    from evaluation_utils import setup_logging, init_nvml, shutdown_nvml, get_memory_usage, NVML_FOUND
  File "/workspace/code/model_evaluator/evaluation_utils.py", line 1, in <module>
    import psutil
ModuleNotFoundError: No module named 'psutil'

2025-04-24 11:16:50,947 - ERROR - ERROR during: Run 3/10: Model='Phi-3-mini-4k-instruct-GPTQ', Benchmark='ctibench', Subset='cti-mcq'
  Command: /workspace/testbedvenv/bin/python /workspace/code/model_evaluator/evaluate_cli.py --model-path /workspace/models/Phi-3-mini-4k-instruct-GPTQ --model-type causal --benchmark-name ctibench --benchmark-path /workspace/datasets --results-dir /workspace/results/mod/48 --num-samples 100 --cti-subset cti-mcq --max-new-tokens 512
  Return Code: 1
  Stderr:
/workspace/testbedvenv/lib/python3.11/site-packages/torch/_subclasses/functional_tensor.py:276: UserWarning: Failed to initialize NumPy: No module named 'numpy' (Triggered internally at /pytorch/torch/csrc/utils/tensor_numpy.cpp:81.)
  cpu = _conversion_method_template(device=torch.device("cpu"))
Traceback (most recent call last):
  File "/workspace/code/model_evaluator/evaluate_cli.py", line 9, in <module>
    from evaluation_utils import setup_logging, init_nvml, shutdown_nvml, get_memory_usage, NVML_FOUND
  File "/workspace/code/model_evaluator/evaluation_utils.py", line 1, in <module>
    import psutil
ModuleNotFoundError: No module named 'psutil'

----------------------------------------

2025-04-24 11:16:50,951 - INFO - 
Run 4/10: Model='Phi-3-mini-4k-instruct-GPTQ', Benchmark='ctibench', Subset='cti-vsp'
2025-04-24 11:16:50,952 - INFO - Executing command: /workspace/testbedvenv/bin/python /workspace/code/model_evaluator/evaluate_cli.py --model-path /workspace/models/Phi-3-mini-4k-instruct-GPTQ --model-type causal --benchmark-name ctibench --benchmark-path /workspace/datasets --results-dir /workspace/results/mod/48 --num-samples 100 --cti-subset cti-vsp --max-new-tokens 512
2025-04-24 11:16:57,928 - WARNING - Stderr:
/workspace/testbedvenv/lib/python3.11/site-packages/torch/_subclasses/functional_tensor.py:276: UserWarning: Failed to initialize NumPy: No module named 'numpy' (Triggered internally at /pytorch/torch/csrc/utils/tensor_numpy.cpp:81.)
  cpu = _conversion_method_template(device=torch.device("cpu"))
Traceback (most recent call last):
  File "/workspace/code/model_evaluator/evaluate_cli.py", line 9, in <module>
    from evaluation_utils import setup_logging, init_nvml, shutdown_nvml, get_memory_usage, NVML_FOUND
  File "/workspace/code/model_evaluator/evaluation_utils.py", line 1, in <module>
    import psutil
ModuleNotFoundError: No module named 'psutil'

2025-04-24 11:16:57,930 - ERROR - ERROR during: Run 4/10: Model='Phi-3-mini-4k-instruct-GPTQ', Benchmark='ctibench', Subset='cti-vsp'
  Command: /workspace/testbedvenv/bin/python /workspace/code/model_evaluator/evaluate_cli.py --model-path /workspace/models/Phi-3-mini-4k-instruct-GPTQ --model-type causal --benchmark-name ctibench --benchmark-path /workspace/datasets --results-dir /workspace/results/mod/48 --num-samples 100 --cti-subset cti-vsp --max-new-tokens 512
  Return Code: 1
  Stderr:
/workspace/testbedvenv/lib/python3.11/site-packages/torch/_subclasses/functional_tensor.py:276: UserWarning: Failed to initialize NumPy: No module named 'numpy' (Triggered internally at /pytorch/torch/csrc/utils/tensor_numpy.cpp:81.)
  cpu = _conversion_method_template(device=torch.device("cpu"))
Traceback (most recent call last):
  File "/workspace/code/model_evaluator/evaluate_cli.py", line 9, in <module>
    from evaluation_utils import setup_logging, init_nvml, shutdown_nvml, get_memory_usage, NVML_FOUND
  File "/workspace/code/model_evaluator/evaluation_utils.py", line 1, in <module>
    import psutil
ModuleNotFoundError: No module named 'psutil'

----------------------------------------

2025-04-24 11:16:57,933 - INFO - 
Run 5/10: Model='Phi-3-mini-4k-instruct-GPTQ', Benchmark='ctibench', Subset='cti-rcm'
2025-04-24 11:16:57,935 - INFO - Executing command: /workspace/testbedvenv/bin/python /workspace/code/model_evaluator/evaluate_cli.py --model-path /workspace/models/Phi-3-mini-4k-instruct-GPTQ --model-type causal --benchmark-name ctibench --benchmark-path /workspace/datasets --results-dir /workspace/results/mod/48 --num-samples 100 --cti-subset cti-rcm --max-new-tokens 512
